<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VisionAssist | Signifi Solutions</title>
    <style>
        :root {
            --primary-navy: #0D202D;
            --primary-blue: #007FC7;
            --accent-cyan: #72E0FB;
            --disconnect-red: #d93025;
            --white: #ffffff;
            --font-main: 'Segoe UI', sans-serif;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: var(--font-main);
            background-color: var(--primary-navy);
            height: 100vh; width: 100vw;
            overflow: hidden;
        }

        /* --- HOME SCREEN --- */
        #home-screen {
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            padding: 10vh 2rem;
            background: radial-gradient(circle at center, #1a3a52 0%, #0d202d 100%);
        }

        .logo-img { max-width: 40%; height: auto; transition: 0.5s; }
        .logo-hidden { transform: translateY(-200px); opacity: 0; }

        /* THE CALL AREA (IFRAME) */
        #call-container {
            width: 90%;
            height: 0; /* Starts hidden */
            background: #000;
            border-radius: 20px;
            overflow: hidden;
            border: 2px solid var(--accent-cyan);
            transition: height 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        #teams-iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* CONTROL BUTTON */
        .call-btn {
            width: 220px; height: 220px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-blue), #005a8e);
            border: 5px solid var(--white);
            color: var(--white);
            font-size: 1.4rem; font-weight: 800;
            cursor: pointer;
            box-shadow: 0 0 30px rgba(0, 127, 199, 0.5);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: all 0.3s ease;
            margin-bottom: 5vh;
        }

        .call-btn.active {
            width: 150px; height: 150px;
            background: var(--disconnect-red);
            font-size: 1rem;
            box-shadow: 0 0 20px rgba(217, 48, 37, 0.5);
        }

        /* ADMIN STUFF */
        #secret-corner { position: absolute; bottom: 0; right: 0; width: 60px; height: 60px; z-index: 100; }
        #admin-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 200; justify-content: center; align-items: center;
        }
    </style>
</head>
<body>

    <div id="home-screen">
        <img id="logo" src="https://raw.githubusercontent.com/kspatel45/VisionAssist/main/signifi-logo.png" class="logo-img">
        
        <div id="call-container">
            <iframe id="teams-iframe" allow="camera; microphone; display-capture; autoplay"></iframe>
        </div>

        <div>
            <button id="main-btn" class="call-btn" onclick="toggleCall()">
                <span id="btn-text">START CALL</span>
            </button>
        </div>

        <div id="secret-corner" onclick="showAdmin()"></div>
    </div>

    <div id="admin-modal">
        <div style="background:white; padding: 2rem; border-radius: 15px; width: 400px; text-align:center;">
            <h3>Kiosk Settings</h3><br>
            <label style="display:block; text-align:left; font-size: 0.8rem;">Teams Meeting URL:</label>
            <input type="text" id="meeting-url" placeholder="Paste Teams Link here" style="width:100%; padding:10px; margin:10px 0;">
            <p style="font-size:0.7rem; color:#666; margin-bottom:15px;">Note: Ensure meeting allows guest access.</p>
            <button onclick="saveSettings()" style="width:100%; padding:10px; background:var(--primary-blue); color:white; border:none; border-radius:5px;">Save & Exit</button>
        </div>
    </div>

    <script>
        let isCalling = false;
        
        // On load, try to get the saved URL
        window.onload = () => {
            const savedUrl = localStorage.getItem('va_meeting_url');
            if(savedUrl) document.getElementById('meeting-url').value = savedUrl;
        };

        function showAdmin() { document.getElementById('admin-modal').style.display = 'flex'; }
        
        function saveSettings() {
            const url = document.getElementById('meeting-url').value;
            localStorage.setItem('va_meeting_url', url);
            document.getElementById('admin-modal').style.display = 'none';
        }

        function toggleCall() {
            const container = document.getElementById('call-container');
            const iframe = document.getElementById('teams-iframe');
            const btn = document.getElementById('main-btn');
            const btnText = document.getElementById('btn-text');
            const logo = document.getElementById('logo');
            const url = localStorage.getItem('va_meeting_url');

            if (!isCalling) {
                if(!url) return alert("Please set a Meeting URL in Admin (bottom right corner)");

                // UI Transform
                isCalling = true;
                logo.classList.add('logo-hidden');
                container.style.height = "70vh";
                btn.classList.add('active');
                btnText.innerText = "END CALL";
                
                // Load Teams in iFrame
                iframe.src = url;
            } else {
                // Reset UI
                isCalling = false;
                logo.classList.remove('logo-hidden');
                container.style.height = "0";
                btn.classList.remove('active');
                btnText.innerText = "START CALL";
                
                // Stop the call by clearing the source
                iframe.src = "";
            }
        }
    </script>
</body>
</html>